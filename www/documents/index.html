<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>Complete Discography | dlove.it</title>

  <!-- Display the same in all browsers.  Must be first stylesheet. -->
  <link href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.css" rel="stylesheet" type="text/css" />
  <link href="style/lib/bootstrap.min.css" rel="stylesheet" type="text/css" />
  <link href="style/style.css" rel="stylesheet" type="text/css" />

  <script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js"></script> 
  <script>
    function get_artists(e) {
      e.preventDefault()
      let uri = encodeURI("/app/artists/"+$("#artist").val())
      console.log("uri="+uri)
      let btnText = $("#submit").html()
      $("#submit").html("Loading...")
      $("#artist-container").hide()
      $("#disco-container").hide()
      $("#loading").show()
      $("#artist-list").load(uri, function() {
        $(".artist_link").each(function() { 
          $(this).click(function() { get_discography($(this).attr("artist_id"), $(this).attr("artist_name")) } ) 
        })
        $("#submit").html(btnText)
        $("#artist-container").show()
        $("#loading").hide()
      })
    }

    function get_discography(id, name) {
      let uri = encodeURI("/app/discography/"+id)
      console.log("uri="+uri)
      let btnText = $("#submit").html()
      $("#submit").html("Loading...")
      $("#artist-container").hide()
      $("#disco-container").hide()
      $("#loading").show()
      $("#disco").load(uri, function() {
        $("#results_heading").html("Complete Discography for "+name)
        $("#stats").addClass("center-me h3")
        $("#submit").html(btnText)
        $("#disco-container").show()
        $("#loading").hide()
      })
    }
  </script>
  <style>
    .limit-width {
      width: 80%;
    }

    .artist {
      position:relative;
      float:left;
      margin: 7px 9px 14px 7px;
      width: 150px;
      height: 205px;
    }

    .artist * {
      display:block;
    }
  </style>
</head>
<body>
  <main class="center-contents">
    <div class="spacey">
      <h1 class="text-primary">Complete Discography</h1>
      <div class="little-spacey">
        <p>If you follow an artist who performs in several different bands, this tool is for you. 
          Enter their name to get a list of every album they've released under all of their various bands and aliases.</p>
        <p>This app uses Python and Flask to retrieve data from <a href="https://discogs.com">Discogs</a> 
          via their handy <a href="https://www.discogs.com/developers">API</a>.  
          Check out the source code on <a href="https://github.com/dfunklove/complete-discography">GitHub</a>.</p>
      </div>
      <form class="bs-component" onsubmit="get_artists(event)">
        <div class="form-group">
          <label for="artist" class="col-form-label-lg">Artist Name</label><br>
          <input class="form-control-lg center-contents" id="artist">
        </div>
      </form>
      <button class="btn btn-primary btn-lg" id="submit" onclick="get_artists(event)">Go!</button>
    </div>
    <div id="artist-container" class="hidden spacey">
      <h2>Please choose your artist.</h2>
      <div id="artist-list" class="center-me limit-width"></div>
    </div>
    <div id="disco-container" class="hidden spacey big-bottom">
      <div class="center-me center-contents jumbotron-background">
        <h2 id="results_heading" class="text-success">Results</h2>
        <div id="disco" class="center-me little-spacey"></div>
      </div>
    </div>
    <div id="loading" class="hidden spacey">
      <img src="images/spinner.svg"/>
    </div>
  </main>
</html>